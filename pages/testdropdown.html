<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        #boite-recherche {
            box-sizing: border-box;
            background-image: url('searchicon.png');
            background-position: 14px 12px;
            background-repeat: no-repeat;
            font-size: 16px;
            padding: 14px 20px 12px 45px;
            border: none;
            border-bottom: 1px solid #ddd;
            width: 100%;
            /* Pour occuper toute la largeur */
        }

        #boite-recherche:focus {
            outline: 3px solid #ddd;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .my-dropdown-content {
            position: absolute;
            background-color: #f6f6f6;
            min-width: 230px;
            overflow: auto;
            border: 1px solid #ddd;
            z-index: 1;
        }

        .my-dropdown-content li {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            cursor: pointer;
            /* Pour montrer que c'est cliquable */
        }

        .my-dropdown-content li:hover {
            background-color: #ddd;
        }

        #ingredients-selectionne {
            padding: 10px;
            background-color: #f6f6f6;
            border: 1px solid #ddd;
        }

        #noResult {
            padding: 10px;
            background-color: #f6f6f6;
            border: 1px solid #ddd;
        }

        #ingredients-selectionne {
            padding: 10px;
            background-color: #f6f6f6;
            border: 1px solid #ddd;
            margin-top: 10px;
            /* Ajout de marge en haut */
        }

        .ingredients-selectionne {
            display: inline-block;
            padding: 5px 10px;
            background-color: #ddd;
            border-radius: 5px;
            margin-right: 5px;
            /* Ajout de marge entre les ingrédients */
            cursor: pointer;
        }

        .ingredients-selectionne:hover {
            background-color: #aaa;
        }
    </style>
</head>

<body style="background-color:white;">

    <section class="dropdown">
        <div id="my-dropdown" class="my-dropdown-content">
            <input type="text" placeholder="Ajouter un ingredient..." id="boite-recherche" onkeyup="filterFunction()">
            <ul id="dropdown-list">
                <!-- Liste vide au début -->
            </ul>
            <div id="noResult" style="display: none;">Aucun résultat</div>
        </div>
    </section>
    <br><br><br>
    <div id="ingredients-selectionne">
        <ul id="liste-selectionne">
            <!-- Liste vide au début -->
        </ul>
    </div>

    <script>
        // Liste des choix
        const allIngredients = ["Vodka", "Rhum", "Gin", "Tequila", "Whiskey", "Triple sec", "Sirop simple", "Jus de citron", "Jus de lime", "Jus d'orange", "Jus de canneberge", "Grenadine", "Jus de pomme", "Jujutsu Kaisen"];
        let selectedIngredients = [];

        // Fonction pour mettre à jour la liste déroulante
        function updateDropdownList() {
            const input = document.getElementById("boite-recherche");
            if (input.value.trim() !== "") {
                filterFunction();
            }
        }

        function addToSelected(ingredient) {
            if (!selectedIngredients.includes(ingredient)) {
                selectedIngredients.push(ingredient);
                updateSelectedIngredients(); // Mettre à jour l'affichage des ingrédients sélectionnés
                updateDropdownList(); // Mettre à jour la liste déroulante
            }
        }

        function toggleSelected(ingredient) {
            const index = selectedIngredients.indexOf(ingredient);
            if (index !== -1) {
                selectedIngredients.splice(index, 1); // Désélectionne l'ingrédient s'il est déjà sélectionné
                removeFromSelectedUI(ingredient); // Supprime l'élément de l'interface utilisateur
            } else {
                addToSelected(ingredient);
            }
        }

        function removeFromSelectedUI(ingredient) {
            const selectedUl = document.getElementById("liste-selectionne");
            const lis = selectedUl.getElementsByTagName("li");
            for (let i = 0; i < lis.length; i++) {
                if (lis[i].textContent === ingredient) {
                    selectedUl.removeChild(lis[i]);
                    break;
                }
            }
        }

        // Fonction pour mettre à jour l'affichage des ingrédients sélectionnés
        function updateSelectedIngredients() {
            const selectedUl = document.getElementById("liste-selectionne");
            selectedUl.innerHTML = ""; // Clear the list before re-populating

            selectedIngredients.forEach(ingredient => {
                const li = document.createElement("li");
                li.textContent = ingredient;
                li.addEventListener("click", function () {
                    toggleSelected(ingredient);
                });
                selectedUl.appendChild(li);
            });
        }

        function filterFunction() {
            const input = document.getElementById("boite-recherche");
            const filter = input.value.trim().toUpperCase();
            const ul = document.getElementById("dropdown-list");
            const noResultDiv = document.getElementById("noResult");
            ul.innerHTML = ""; // Clear the list at each search

            let hasResults = false;

            allIngredients.forEach(ingredient => {
                if (ingredient.toUpperCase().indexOf(filter) > -1 && !selectedIngredients.includes(ingredient)) {
                    hasResults = true;
                    const li = document.createElement("li");
                    li.textContent = ingredient;
                    li.addEventListener("click", function () {
                        toggleSelected(ingredient);
                    });
                    ul.appendChild(li);
                }
            });

            // Show the dropdown list
            document.getElementById("my-dropdown").classList.toggle("show", hasResults);

            // Display "No result" if no result found
            noResultDiv.style.display = hasResults ? "none" : "block";
        }

        document.addEventListener("click", function (event) {
            const dropdown = document.getElementById("my-dropdown");
            const input = document.getElementById("boite-recherche");
            const dropdownList = document.getElementById("dropdown-list");

            if (dropdown.classList.contains("show") && event.target !== input && !dropdownList.contains(event.target)) {
                dropdown.classList.remove("show");
            }
        });

        // Event handler to open the dropdown list when the user clicks on the search box
        document.getElementById("boite-recherche").addEventListener("click", function (event) {
            const dropdown = document.getElementById("my-dropdown");
            dropdown.classList.add("show");
            event.stopPropagation(); // To prevent click event propagation to the window
        });

        // Initial call to ensure the selected ingredients box is visible
        updateSelectedIngredients();

    </script>


</body>

</html>
